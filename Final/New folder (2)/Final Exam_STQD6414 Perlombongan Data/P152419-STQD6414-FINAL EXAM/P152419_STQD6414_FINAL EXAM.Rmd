---
title: "PEPERIKSAAN AKHIR STQD6414"
author: "P152419"
date: "2025-02-22"
output: 
  pdf_document:
    toc: true
    toc_depth: 6
---

# Question 1

a)  

    i)  Penurunan data merupakan pendekatan untuk menurunkan dimensi ataupun bilangan data. Contoh kaedah penurunan dimensi data adalah Analisis Faktor dan Principal Component Analisis (PCA). Manakalah contoh bagi penurunan bilangan data adalah membuang data yang tidak relevan. Antara tujuan penurunan data adalah bagi mengatasi masalah autokorelasi di antara atribut-atribut dalam sesuatu data tersebut.
    ii) Pendiskretan data pula merupakan pendekatan bagi mengubah data daripada bentuk nombor kepada bentuk kategori. Ini bertujuan bagi menyesuaikan data mengikut model pembelajaran mesin yang ingin dilakukan.

b)  

    i)  

```{r}
# load data
dm1 = read.csv('./Data/data.DM1.csv')
dm2 = read.table('./Data/data.DM2.txt')
head(dm1)
```

```{r}
colnames(dm1)
```

```{r}
colnames(dm2)
```

```{r}
data = merge(dm1, dm2, by.x = 'ID.Customer', by.y = 'cust.id')
head(data)
```

```{r ,warning = FALSE, message = FALSE}
library(mice)
md.pattern(data)
```

```{r}
table(data$Working)
```

```{r}
table(data$Home.Status)
```

```{r}
table(data$recent.move)
```

```{r}
vehicle = median(data$num.vehicles, na.rm = T)
vehicle
```

```{r}
data$Working = ifelse(is.na(data$Working), TRUE ,data$Working) #logical
data$Home.Status = ifelse(is.na(data$Home.Status), 'Homeowner with mortgage/loan',
                          data$Home.Status) # category
data$recent.move = ifelse(is.na(data$recent.move), FALSE,
                          data$recent.move) # logical
data$num.vehicles = ifelse(is.na(data$num.vehicles), vehicle,
                           data$num.vehicles) # integer
```

```{r}
md.pattern(data)
```

ii\.

```{r ,warning = FALSE, message = FALSE}
library(dplyr) 

# maklumat individu bekerja
data1 = data %>%
  filter(Working == TRUE) %>%
  select('state.of.res', 'age', 'Median.Income', 'marital.stat', 'Home.Status', 'sex')

# maklumat individu tidak bekerja
data2 = data %>%
  filter(Working == FALSE) %>%
  select('state.of.res', 'age', 'Median.Income', 'marital.stat', 'Home.Status', 'sex')
```

# Question 2 - Perlombongan Aturan Sekutuan

a\.

algoritma apriori digunakan bagi melihat pola dan aturan dalam data yang mempunyai konsep support, confidence dan juga lift

-   Support : peratusan transaksi yang mempunyai barang yang tertentu

-   Confidence : peratusan transaksi yang mempunyai barang A juga mempunya barang B

-   Lift : Kebarangkalian barang A dibeli apabila barang B dibeli

b\.

i\.

```{r ,warning = FALSE, message = FALSE}
library(arules)
bread = read.transactions('./Data/BreadBasket.csv', format = 'single', header = T,
                          sep = ',', cols = c('Transaction','Item'))

arules::inspect(arules::unique(head(bread)))
```

ii\.

```{r}
#
itemFrequencyPlot(bread, topN = 10)
```

iii\.

```{r}
rule = apriori(bread, parameter=list(supp=0.01, conf=0.2))
```

iv\.

```{r}
rule = apriori(bread, parameter=list(supp=0.01, conf=0.2),
               appearance=list(default='lhs', rhs='Coffee'))
```

v\.

```{r ,warning = FALSE, message = FALSE}
library(arulesViz)
plot(rule, method = 'graph')
```

```{r}
plot(rule, method = 'paracoord')
```

# Question 3

a)  

    a)  Spatial_Lines merupakan bentuk data reruang di mana setiap titik kedudukan akan disambungkan kepada titik kedudukan yang seterusnya menggunakan garis

    b)  Saptial_Polygon pula merupakan bentuk data reruang di mana ianya seperti bentuk spatial line tetapi tidak mempunyai titik yang tidak bersambung. Ini kerana, titik terakhir akan disambungkan kepada titik pertama.

b)  

    a)  

```{r}
stesen = c('A', 'B', 'C', 'D', 'E', 'F', 'G', 'H')
Latitud = c(45.3, 42.6, 38.9, 42.1, 35.7, 38.9, 36.2, 39)
Longitud = c(-116.7, -120.4, -116.7, -113.5, -115.5, 120.8, -119.5, -113.7)
Suhu = c(40.5, 32.1, 14.4, 40.1, 33.2, 27.4, 27.8, 31.3)
Jumlah.Hujan.Mingguan = c(184.85, 300.11, 3.53, 405.67, 94.78, 794.84, 154.67,
                          594.85)

reruang = data.frame(stesen, Latitud, Longitud, Suhu, Jumlah.Hujan.Mingguan)

head(reruang)
```

```{r ,warning = FALSE, message = FALSE}
library(sp)
library(rspat)
crdref = CRS('+proj=longlat +datum=WGS84')
lonlat = cbind(reruang$Latitud, reruang$Longitud)
pts = SpatialPoints(lonlat, proj4string = crdref)
plot(pts, axes = T)
```

ii\.

```{r}
model = glm(Suhu~Jumlah.Hujan.Mingguan, data = reruang)
summary(model)
```

# Question 4 - Perlombongan Data Graf

a)  Kemodularan merupakan ukuran struktur rangkaian dengan nod-nod mempamerkan pengelompokan jika terdapat ketumpata yang lebih besar dalam kelompok atau kurang ketumpatan di antara mereka.

b)  

c)  

```{r ,warning = FALSE, message = FALSE}
library(UserNetR)
data("DHHS")
class(DHHS)
```

Analisis Nod Prominen

```{r, warning = FALSE, message = FALSE}
library(statnet)
degree(DHHS)
```

```{r}
closeness(DHHS)
```

```{r}
betweenness(DHHS)
```

iii) 

```{r}

```

b)  

```{r}

```

# Question 5 - Perlombongan Data Teks

a)  lexicon merupakan senarai perkataan yang berperanan untuk menentukan sesuatu perkataan tersebut merupakan perkataan yang positif ataupun perkataan yang negatif.

b)  Aplikasi analisis sentiment dapat mengklasifikasikan perkataan kepada 8 emosi asas iaitu *Anger, Fear, Anticipation, Trust, Surprise, Sadness, Joy, Disgust.*

c)  

```{r}
text = readLines('./Data/data.txt')

class(text)
```

```{r ,warning = FALSE, message = FALSE}
library(tm)

docs=Corpus(VectorSource(text))
inspect(head(docs))
```

```{r, warning = FALSE}
tospace = content_transformer(function(x, pattern) gsub(pattern, '', x))

doc2 = tm_map(docs, tospace, '!')
doc3 = tm_map(doc2, tospace, ':')
doc4 = tm_map(doc3, tospace, ',')
doc5 = tm_map(doc4, content_transformer(tolower))
doc6 = tm_map(doc5, removeNumbers)
doc7 = tm_map(doc6, removeWords, stopwords('english'))
doc8 = tm_map(doc7, removePunctuation)
doc9 = tm_map(doc8, stripWhitespace)
doc10 = tm_map(doc9, stemDocument)

dtm = TermDocumentMatrix(doc10)
m = as.matrix(dtm)

dim(m)
```

```{r ,warning = FALSE, message = FALSE}
v = sort(rowSums(m), decreasing = T)
d = data.frame(word = names(v), freq = v)
library(wordcloud)
wordcloud(words = d$word, freq = d$freq, min.freq = 50, max.words = 25,
          random.order = F, colors = brewer.pal(8, 'Dark2'))
```

Berdasarkan maklumat yang diperoleh daripada awan perkataan, whale merupakan perkataan yang paling kerap diulang di dalam teks tersebut.
